=pod

=head1 DESCRIPTION

Выводит короткий отчёт о выходящих в ИС объектах: хостах, группах параметров мониторинга, параметрах мониторинга

=head1 SYNOPSIS
 
 Синтаксис вызова в порядке убывания "важности" опций:
 report_group_host_item_trigger.pl
  -s @CONNECT_OPTIONS		Параметры коннекта к фронтэнду
  [-d OUTDIR]			Каталог назначения, то есть каталог, в котором будут созданы файлы результата
  [-o]				Вывести результат на стандартный вывод, а не создавать файлы
  [-g INCLUDE_GROUP]		Показывать только ИС, соотв.-е указанной маске (маска в стиле файловой маски UNIX: "*АСГУФ*Инфра")
  [-x @EXCLUDE_GROUPS]		Исключить перечисленные ИС из вывода. ИС указываются как регулярное выражение, а не в стиле файловой маски (см. опцию -g, где всё наоборот)!
  [-f FLD_SEP]			Символ разделителя полей в CSV (будет использован только первый символ строки)
  [-q TEXT_QUOTE]		Символ кавычек, обрамлящих текст в CSV. ВНИМАНИЕ: по умолчанию используется одинарная, а не двойная кавычка!
  [-m @FLDS_NUM]		Последовательность номеров полей в таблице результата. Позволяет отключать ненужные столбцы и/или переставлять их местами.

=head1 DETAILS

=head2 OPTIONS

=over 4

=item

Параметры опции "-s" перечисляются друг за другом в следующем порядке: Имя_Сервера Логин Пароль,
где:
 Имя_Сервера - это IP или Hostname сервера фронтэнда (веб-интерфейса Zabbix)
 Логин       - имя пользователя, имеющего как минимум права на чтение тех хостгрупп, которые зап-
               рашиваются в отчёте, а также тех хостгрупп, к которым относятся соотв. шаблоны
 Пароль      - пароль пользователя

В параметре "-d" указывается тот каталог, в котором будет созданы файлы в формате CSV, по одному 
файлу на каждую найденную хостгруппу. При задании опций -d и -o одновременно действовать будет 
только опция "-o": предполагается, что пользователь понимает, что он делает и читает документацию,
поэтому подробная проверка параметров на взаимную противоречивость (как это имеет место в случае оп-
ций -d и -o) не осуществляется.

Если указана опция "-o", весь вывод будет отправлен в STDOUT. При этом заголовок таблицы будет повто-
ряться для каждой хостгруппы. Возможно, это не вполне корректное поведение и лучше было бы укзывать 
заголовок только один раз, поэтому в будущем поведение утилиты при указании ключа -o может изменить-
ся.

Опция "-g" позволяет указать маску, по которой будет осуществляться поиск хостгрупп. Обра-
тите внимание на то, что маска в данном случае должна описывать имя формат имени хостгруппы целиком:
например, если вы ищете группу с именем "The LongBeach Office", то недостаточно указать просто "LongBeach",
в этом случае маска должна быть такой: "*LongBeach*".

Опция "-x" позволяет указать фильтр, по которому группы будут отсеиваться группы ИЗ УЖЕ НАЙДЕННЫХ. То 
есть данная опция не сузит область поиска, но исключит из вывода неподходящие вам результаты.

Разделитель полей в CSV-файле можно указать с помощью опции "-f". Это бывает полезно, когда в CSV-файле 
на выходе предполагается наличие "стандартного"  (вообще говоря, он не очень стандартный  :)) раздели-
теля (символа ";") в строках значений столбцов, а разбирать этот CSV предстоит не очень умным утилитам, 
которые запросто могут перепутать содержимое поля и разделитель полей.

Обрамляющие текст в CSV-файле кавычки можно указать в опции "-q". По умолчанию используется одинарная 
кавычка ввиду невысокой вероятности интерференции с содержимым текстовых полей. В опции -q можно ука-
зать и пустую строку, тогда текстовые поля не будут обрамляться кавычками вовсе, и в этом вам нужно будет
самостоятельно убедиться в том, что ни одно из текстовых полей не содержит символ разделителя (см. описа-
ние для опции "-f").
ВНИМАНИЕ: из рациональных соображений оптимизации производительности поиск и экранирование кавычек внутри 
текстовых полей не осуществляется, поэтому если вы получите неудовлетворяющий вас результат, просто задай-
те другое значение опции "-q" и попробуйте снова.

Опция "-m" позволяет задать порядок следования и наличие столбцов (полей вывода) с указанными номерами в 
таблице CSV. Столбцы нумеруются начиная с нуля (0). Указание данной опции позволяет сократить объём вывода,
но никак не влияет на объём запрашиваемых у Zabbix API данных.

Опция "-b" задаёт последовательность следования блоков свойств объектов Zabbix и параметрами её являются 
собственно имена объектов. Например, если вы укажете "Group" "Item"  "Host", то сначала будут выведены все 
свойства хостгрупп, затем все свойства итема, а только потом свойства хоста. В настоящий момент является 
"поломанной опцией", пользуйтесь ключом "-m" для достижения аналогичного эффекта посредством указания после-
довательностми следования полей по номерам.

=back
=head1 EXAMPLE OUTPUT

 Наименование ИС;Имя хоста ИИС;IP адрес;Протокол;Метод опроса;Группа параметров;Параметр;Наличие триггера;
 ИС АГ (Инфраструктура ИС);IS45-AG-SERVERSIDE;10.127.49.26;;;0. Интегральные показатели;[0.0] Интегральный показатель качества: хост;Нет;
 ИС АГ (Инфраструктура ИС);IS45-AG-SERVERSIDE;10.127.49.26;;;0. Интегральные показатели;[0.2.2.6] Загрузка процессора: interrupt;Нет;
 ИС АГ (Инфраструктура ИС);IS45-AG-SERVERSIDE;10.127.49.26;;;0. Интегральные показатели;[0.2.2.2] Загрузка процессора: system;Нет;
 ...
 
=cut